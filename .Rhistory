df_37 = data.frame(observation_grid(p.eval, comp = "full"),
as.vector(c_val2),
as.vector(est2),
as.vector(est_wd))
colnames(df_37) = c("x1", "x2", "c_val2", "est2", "est_wd")
figure37a = plot_ly(df_37) |>
add_surface(x = x,
y = x,
z = c_val2,
size = .4, alpha = .7,
showscale = F) |>
add_surface(x = x,
y = x,
z = est2,
size = .4, alpha = .2, colorscale = cs2,
showscale = F)  |> back_layout(x = 1.9, y = .9, z = 1.3)
figure37a
rm(list = setdiff(ls(),
c("figure31a", "figure31b",
"figure32a", "figure32b",
"figure37a", "figure37b")))
figure37a = plot_ly(df_37) |>
add_surface(x = x,
y = x,
z = c_val2,
size = .4, alpha = .7,
showscale = F) |>
add_surface(x = x,
y = x,
z = est2,
size = .4, alpha = .2, colorscale = cs2,
showscale = F)  |> back_layout(x = 1.9, y = .9, z = 1.3)
figure37b
df_37
figure37a
df.all
#### results ####
# instead of evaluating the functions all again the results can be loaded with
load("cov/data/illustrations.RData")
Z.all
df.all
##### Figure 3.7 (a) #####
df_37 = data.frame(observation_grid(p.eval, comp = "full"),
as.vector(c_val2),
as.vector(est2),
as.vector(est_wd))
colnames(df_37) = c("x1", "x2", "c_val2", "est2", "est_wd")
figure37a = plot_ly(df_37) |>
add_surface(x = ~x1,
y = ~x2,
z = ~c_val2,
size = .4, alpha = .7,
showscale = F) |>
add_surface(x = ~x1,
y = ~x2,
z = ~est2,
size = .4, alpha = .2, colorscale = cs2,
showscale = F)  |> back_layout(x = 1.9, y = .9, z = 1.3)
figure37a
Z.all
df.all
##### Figure 3.9 (a) #####
plot_ly() |>
add_surface(x = x, y = x, z = G10_UP, alpha = .8) |>
add_surface(x = x, y = x, z = G10_DN, alpha = .8) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2) |>
add_surface(x = x, y = x, z = estimate_DN, alpha = .8, colorscale = cs2) |>
layout(scene = list(xaxis = list(title = ""),
yaxis = list(title = ""),
zaxis = list(title = "")))
#### results ####
load("cov/data/results_figure_3_9.RData") # for Illustration in Figure 3.9
##### Figure 3.9 (a) #####
plot_ly() |>
add_surface(x = x, y = x, z = G10_UP, alpha = .8) |>
add_surface(x = x, y = x, z = G10_DN, alpha = .8) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2) |>
add_surface(x = x, y = x, z = estimate_DN, alpha = .8, colorscale = cs2) |>
layout(scene = list(xaxis = list(title = ""),
yaxis = list(title = ""),
zaxis = list(title = "")))
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
back_layout(x = 1.9, y = .9, z = 1.3)
figure39a
source("cov/functions.R")
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
back_layout(x = 1.9, y = .9, z = 1.3)
figure39a
save_image(figure39a,
file = "cov/grafics/2rv_estimate_m1_h01.pdf",
width = 600, height = 750)
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
back_layout(x = 1.9, y = .9, z = 1.3)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
back_layout(x = 1.9, y = .9, z = 0.4)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -1.9, y = -.9, z = 0.4)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = 1.9, y = -.9, z = 0.4)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = 1.9, y = -.9, z = 0.8)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = 1.4, y = -.9, z = 0.8)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -1.4, y = .9, z = 0.8)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -1.4, y = .9, z = 1.2)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -1.4, y = 1.1, z = .8)
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -1.4, y = -1.1, z = .8)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -.9, y = -1.1, z = .8)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -.7, y = -1.1, z = .8)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -1, y = -1, z = .8)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -1, y = -1.4, z = .8)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -1, y = -2, z = .8)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -1, y = -2.2, z = .8)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -1.1, y = -2.2, z = .8)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -.9, y = -2.2, z = .8)
figure39a
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -.9, y = -2.3, z = .8)
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -.9, y = -2.3, z = .7)
figure39a
save_image(figure39a,
file = "cov/grafics/OU_G10.pdf",
width = 600, height = 750)
##### Figure 3.9 (b) #####
figure39b = plot_ly() |>
add_surface(x = x, y = x, z = G10_2, alpha = .8) |>
add_surface(x = x, y = x, z = estimate_2UP, alpha = .8, colorscale = cs2, showscale = F) |>
add_surface(x = x, y = x, z = estimate_2DN, alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -.9, y = -2.3, z = .7)
figure39b
source("cov/functions.R")
# Parameter OU Process
theta = 2; sigma = 3
sd = 0.75
p.eval = 150
p = 50
n = 100#
h = 0.6
x.design = (1:p - 0.5)/p
#set.seed(99)
Y = biLocPol::OU(n, x.design, sigma = sigma, alpha = theta) + matrix(rnorm(n * p, 0, sd), n, p) # n x p
Z = observation_transformation(Y)
w = local_polynomial_weights(p, h, p.eval, F, m = 2, grid.type = "less", del = 1)
#### results ####
load("cov/data/results_figure_3_9.RData") # for Illustration in Figure 3.9
x = observation_grid(p.eval, comp = "full")[1:p.eval, 1]
G10 = matrix(apply(observation_grid(p.eval, comp = "full"), 1, del10_cov_OU), p.eval, p.eval)
UP = upper.tri(G10, diag = T)
G10_UP = G10
G10_UP[!UP] = NA
G10_DN = G10
G10_DN[UP] = NA
estimate_UP = estimate
estimate_DN = estimate
estimate_DN[UP] = NA
estimate_UP[!UP] = NA
trim = which(x.design > 0.2 & x.design < 0.8)
cs2 = lisG10_UPcs2 = list(c(0, 1), c("lightblue", "darkred"))
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -.9, y = -2.3, z = .7)
source("cov/functions.R")
G10 = matrix(apply(observation_grid(p.eval, comp = "full"), 1, del10_cov_OU), p.eval, p.eval)
UP = upper.tri(G10, diag = T)
G10_UP = G10
G10_UP[!UP] = NA
G10_DN = G10
G10_DN[UP] = NA
estimate_UP = estimate
estimate_DN = estimate
estimate_DN[UP] = NA
estimate_UP[!UP] = NA
trim = which(x.design > 0.2 & x.design < 0.8)
cs2 = lisG10_UPcs2 = list(c(0, 1), c("lightblue", "darkred"))
##### Figure 3.9 (a) #####
##### Figure 3.9 (a) #####
figure39a = plot_ly() |>
add_surface(x = x, y = x, z = G10_UP,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = G10_DN,
alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_UP, alpha = .8, colorscale = cs2,
showscale = F) |>
add_surface(x = x, y = x, z = estimate_DN,
alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -.9, y = -2.3, z = .7)
figure39a
#### results ####
load("cov/data/results_figure_3_9a.RData") # for Illustration in Figure 3.9a
figure39a
save_image(figure39a,
file = "cov/grafics/OU_G10.pdf",
width = 600, height = 750)
load("cov/data/results_figure_3_9b.RData") # for Illustration in Figure 3.9b
load("cov/data/results_figure_3_9b.RData") # for Illustration in Figure 3.9b
##### Figure 3.9 (b) #####
figure39b = plot_ly() |>
add_surface(x = x, y = x, z = G10_2, alpha = .8, showscale = F) |>
add_surface(x = x, y = x, z = estimate_2UP, alpha = .8, colorscale = cs2, showscale = F) |>
add_surface(x = x, y = x, z = estimate_2DN, alpha = .8, colorscale = cs2, showscale = F) |>
front_layout(x = -.9, y = -2.3, z = .7)
figure39b
save_image(figure39a,
file = "cov/grafics/2rv_G10.pdf",
width = 600, height = 750)
rm(list = setdiff(ls(),
c("figure39a", "figure39b")))
save.image("cov/data/figure_3_9.RData")
load("cov/data/figure_3_9.RData")
load("cov/data/figure_3_9.RData")
saveWidget(figure39a, "docs/figure39a.html", selfcontained = T)
figure39a
saveWidget(figure39a, "docs/figure39a.html", selfcontained = T)
saveWidget(figure39b, "docs/figure39b.html", selfcontained = T)
#### results ####
# instead of evaluating the functions all again the results can be loaded with
load("cov/data/illustrations.RData")
##### Figure 3.2 (a) #####
figure32a = plot_ly(df.all, x = ~Var1, y = ~Var2, z = ~Z.all, size = .4) |>
add_surface(x = x, y = x, z = cov.ou.eval, alpha = .3, showscale = F) |>
add_surface(x = x, y = x, z = est, colorscale = cs2, alpha = .3, showscale = F)
figure32a |> back_layout(x = 2.4, y = 1, z = .6)
figure32a
save_image(figure32a,
file = "cov/grafics/ou_estimate_m1_h03_sd05.pdf",
width = 600, height = 750)
##### Figure 3.2 (b) #####
# compare estimate without the diagonal and without mirroring with actual kernel
figure32b = plot_ly(df.all, x = ~Var1, y = ~Var2, z = ~Z.all, size = .4) |>
add_surface(x = x, y = x, z = cov.ou.eval, alpha = .3, showscale = F) |>
add_surface(x = x, y = x, z = est_standard, colorscale = cs2, alpha = .3,
showscale = F) |>
back_layout(x = 2.4, y = 1, z = .6)
figure32b
save_image(figure32b,
file = "cov/grafics/ou_estimate_m1_h02_full_sd05.pdf",
width = 600, height = 750)
##### Figure 3.7 (a) #####
df_37 = data.frame(observation_grid(p.eval, comp = "full"),
as.vector(c_val2),
as.vector(est2),
as.vector(est_wd))
colnames(df_37) = c("x1", "x2", "c_val2", "est2", "est_wd")
figure37a = plot_ly(df_37) |>
add_surface(x = x,
y = x,
z = c_val2,
size = .4, alpha = .7,
showscale = F) |>
add_surface(x = x,
y = x,
z = est2,
size = .4, alpha = .2, colorscale = cs2,
showscale = F)  |> back_layout(x = 1.9, y = .9, z = 1.3)
figure37a
save_image(figure37a,
file = "cov/grafics/2rv_estimate_m1_h01.pdf",
width = 600, height = 750)
##### Figure 3.7 (b) #####
figure37b = plot_ly(df_37) |>
add_surface(x = x,
y = x,
z = c_val2,
size = .4, alpha = .7,
showscale = F) |>
add_surface(x = x,
y = x,
z = est_wd,
size = .4, alpha = .7, colorscale = cs2,
showscale = F) |>
back_layout(x = 1.9, y = .9, z = 1.3)
figure37b
save_image(figure37b,
file = "cov/grafics/2rv_estimate_m1_h01.pdf",
width = 600, height = 750)
save.image("cov/data/illustrations.RData")
